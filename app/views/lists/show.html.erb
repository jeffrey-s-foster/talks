<div class="list-descr">
  <div class="actions">
    <% if can? :edit, @list %>
      <div class="action"><%= link_to "edit", edit_list_path(@list) %></div>
    <% end %>
    <% if can? :destroy, @list %>
      <div class="action"><%= link_to "delete", @list, :confirm => 'Are you sure?', :method => :delete %></div>
    <% end %>
    <div class="subscribe-table">
      <div class="action subscribe"><%= link_to "subscribe", subscribe_list_path(@list), :remote => true %></div>
      <div class="action unsubscribe"><%= link_to "unsubscribe", unsubscribe_list_path(@list), :remote => true %></div>
      <div class="action watch"><%= link_to "watch", watch_list_path(@list), :remote => true %></div>
    </div>
  </div>
  <div class="name">
    <%= @list.name %>
    <span class="subscribed"></span>
    <span class="watched"></span>
  </div>

  <div class="short-descr"><%= @list.short_descr.html_safe %></div>

  <div class="long-descr"><%= @list.long_descr.html_safe %></dev>
</div>

<hr/>

<% if @upcoming then %>
  <span class="header">Upcoming talks</span> (<%= link_to "See all talks", show_all_list_path(@list) %>)
<% else %>
  <span class="header">All talks (including past talks)</span> (<%= link_to "See upcoming talks only", @list %>)
<% end %>

<div class="short-talks">
  <% if @talks.length == 0 %>
    No <%= if @upcoming then "upcoming" end %> talks
  <% end %>

  <%= render :partial => "talks", :locals => { :talks => @talks } %>
</div>

<div class="organizers">
  <hr/>
  <% if @list.owners.length > 0 %>
    This list is organized by
    <%= join_with_and(@list.owners.map { |u| u.name }) %>
  <% end %>
</div>

<script>
  <% if not @subscription %>
    $(".subscribed").hide();
    $(".watched").hide();
    $(".subscribe").click(function () { $("body").spin() });
    $(".watch").click(function () { $("body").spin() });
    $(".unsubscribe").hide();
  <% elsif @subscription.kind == :kind_watch %>
    $(".subscribed").hide();
    $(".subscribe").click(function () { $("body").spin() });
    $(".watch").hide();
    $(".unsubscribe").click(function () { $("body").spin() });
  <% elsif @subscription.kind == :kind_full %>
    $(".watched").hide();
    $(".subscribe").hide();
    $(".watch").click(function () { $("body").spin() });
    $(".unsubscribe").click(function () { $("body").spin() });
  <% end %>
</script>